// speaker
NSError *error;
AVAudioSession *audioSession = [AVAudioSession sharedSession];
[audioSession setCategory:AVAudioSessionCategoryPlayAndRecord error:&error];

[audioSession overrideOutputAudioPort:AVAudioSessionPortOverrideNone error:&error]; // speaker off
[audioSession overrideOutputAudioPort:AVAudioSessionPortOverrideSpeaker error:&error]; // speaker on


// torch
AVCaptureDevice *device;

[device lockForConfiguration:nil];
device.setTorchMode = AVCaptureTorchModeOn;
[device unlockForConfiguration];
